
    <h1 id="configuration">Configuration</h1>
<p>Basically, you are free, how to configure the OeREB Client. All you need
to do, is updating the settings dictionary of the Pyramid configuration.
This dictionary has to be extended with an <code>oereb_client</code> element that
contains the parameters described below.</p>
<p>It&#39;s recommended to use a YAML file, as described in the next section,
but you don&#39;t have to.</p>
<h2 id="update-the-pyramid-configuration">Update the Pyramid configuration</h2>
<p>In this example, the configuration file for the OeREB Client is named
<code>oereb_client.yml</code>. You can create this file in your application&#39;s root
directory.</p>
<p>The next step is to define this file in your application&#39;s INI file. For
example, open the <em>development.ini</em> file and add the following line
within the <em>app:main</em> section:</p>
<pre><code>oereb_client.cfg = %(here)s/oereb_client.yml
</code></pre>
<p>You can call it whatever you want, but it makes sense to use the package
name. You could also use an already existing file, e.g. from
<code>pyramid_oereb</code>. The variable <code>%(here)s</code> stands for the root directory
and will be replaced by its absolute path.</p>
<p>As you&#39;ve now defined, where your configuration file is placed, you can
parse its content. Open the <code>__init__.py</code> of your application and apply
the follow changes:</p>
<ol>
<li>Add the required imports at the top of the file.<pre><code class="lang-python">import codecs
import yaml
</code></pre>
</li>
<li>Update your <code>main</code> method to read and parse the configuration file.
The location of the configuration is available in the existing
settings dictionary (from the INI file). To read the configuration,
it&#39;s recommended to use the <code>codecs</code> library to avoid errors due to
special characters. The file content gets parsed using the <code>yaml</code>
library and directly applied onto the settings dictioinary.<pre><code class="lang-python">def main(global_config, **settings):
    &quot;&quot;&quot;
    This function returns a Pyramid WSGI application.
    &quot;&quot;&quot;
    config = Configurator(settings=settings)
    settings = config.get_settings()
    with codecs.open(settings.get(&#39;oereb_client.cfg&#39;), encoding=&#39;utf-8&#39;) as f:
        settings.update(yaml.load(f.read()).get(&#39;vars&#39;))
    ...
    config.scan()
    return config.make_wsgi_app()
</code></pre>
</li>
</ol>
<p>Now everything is set up to configure the OeREB Client.</p>
<h2 id="configure-the-oereb-client">Configure the OeREB Client</h2>
<p>Add your configuration in the created <code>oereb_client.yml</code>. The top-level
element has to be called <code>oereb_client</code>. The following example shows
such a configuration and explains the parameters.</p>
<pre><code class="lang-yaml"># OeREB Client
oereb_client:

  # Global application configuration.
  # Possible parameters are:
  #   title:                The application title
  #   icon:                 URL of the icon (favicon) to be used
  #   logo_canton:          URL of your cantonal logo
  #   logo_oereb:           URL of the OeREB logo
  #   local_storage_prefix: A prefix to be used for storing values in
  #                         the browser&#39;s local storage. (optional)
  application:
    title: My OeREB Client
    icon: https://example.com/favicon.png
    logo_canton: https://example.com/logo_canton.png
    logo_oereb: https://example.com/logo_oereb.png
    local_storage_prefix: oerebClient

  # The view configuration for Openlayers.
  # You can define the default initial extent via the map center (map_x
  # and map_y) and the zoom level (map_zoom).
  # Optionally, you can also restrict the resolutions.
  view:
    map_x: 2615000
    map_y: 1255000
    map_zoom: 2
    resolutions: [250, 100, 50, 20, 10, 5, 2.5, 2, 1.5, 1, 0.5, 0.25, 0.1, 0.05, 0.025, 0.01]

  # A base layer has to be defined. You have two options: WMS and WMTS.
  # The &quot;params&quot; attribute in the WMS configuration allows all values
  # according to the ol.source.ImageWMS documentation:
  # https://openlayers.org/en/v4.2.0/apidoc/ol.source.ImageWMS.html
  #
  # WMS configuration:
  #   type: wms
  #   url: https://example.com/wms
  #   params:
  #     LAYERS: layer1,layer2
  #     FORMAT: image/png
  #
  # WMTS configuration:
  #   type: wmts
  #   url: https://example.com/wmts/1.0.0/capabilities.xml
  #   layer: my_base_map
  #   matrixSet: swissgrid
  #   projection: &quot;EPSG:2056&quot;
  #   style: default
  #   format: image/png
  #
  base_layer:
    type: wmts
    url: https://example.com/wmts/1.0.0/capabilities.xml
    layer: my_base_map
    matrixSet: swissgrid
    projection: &quot;EPSG:2056&quot;
    style: default
    format: image/png

  # The availability layer can be used to display an overview of the
  # available/published municipalities. You have to define a WMS URL and
  # params according to the ol.source.ImageWMS documentation:
  # https://openlayers.org/en/v4.2.0/apidoc/ol.source.ImageWMS.html
  # At least &quot;LAYERS&quot; has to be defined.
  availability:
    url: https://example.com/wms
    params:
      LAYERS: oereb_published_municipalities
      FORMAT: image/png

  # The API used for the search field. The client currently works with
  # the full text search API of GeoMapfish and its WFS. But you could
  # replace it by any other service that returns the same format
  # (GeoJSON).
  search:
    api:
      url: https://my.geomapfish.com/wsgi/bl_fulltextsearch
      limit: 5
    wfs:
      url: https://my.geomapfish.com/wsgi/mapserv_proxy
      limit: 5

  # Link to external viewer/portal
  # Use this parameter to configure the link to an external viewer or
  # portal. The defined URL gets opened in a new tab. The list of
  # parameters gets joined with &quot;&amp;&quot; and is appended to the URL. You
  # can add special keywords, e.g. &quot;{egrid}&quot;, that are replaced by the
  # current values of the real estate and the map. The available
  # keywords are:
  # - map_x             Center of map (X value)
  # - map_y             Center of map (Y value)
  # - map_zoom          Map zoom level
  # - egrid             EGRID of current real estate
  # - canton            Canton of current extract
  # - fosnr             FOS number of current municipality
  # - identdn           Ident DN of current real estate
  # - municipality      Current municipality name
  # - number            Number of current real estate
  external_viewer:
    tooltip: Open in external viewer
    url: https://my.webgis.com
    params:
      - &quot;egrid={egrid}&quot;
      - &quot;foo=bar&quot;

  # Your support address. This will be shown if an error occurs.
  support:
    office1: My Department
    office2: My Office
    street: Street 1a
    city: 1234 City
    email: support@example.com
    phone: 061 123 45 67

  # Custom CSS file
  # Add the URL to a custom CSS file to adjust styles.
  custom_css_url: https://example.com/mystyle.css

  # Enable Google Analytics by specifying account key. Leave this
  # parameter undefined to disable Google Analytics.
  google_analytics: UA-12345678-9
</code></pre>


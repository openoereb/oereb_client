import{B as I,a as m,c as M,b as d,d as O,u as g,l as h,e as R,O as x,E as v,g as E,f as Z}from"./extent-4SmnXT51.js";const n={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class N extends I{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[n.OPACITY]=e.opacity!==void 0?e.opacity:1,m(typeof t[n.OPACITY]=="number","Layer opacity must be a number"),t[n.VISIBLE]=e.visible!==void 0?e.visible:!0,t[n.Z_INDEX]=e.zIndex,t[n.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[n.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[n.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[n.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},s=this.getZIndex();return t.opacity=M(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=s===void 0&&!t.managed?1/0:s,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return d()}getLayerStatesArray(e){return d()}getExtent(){return this.get(n.EXTENT)}getMaxResolution(){return this.get(n.MAX_RESOLUTION)}getMinResolution(){return this.get(n.MIN_RESOLUTION)}getMinZoom(){return this.get(n.MIN_ZOOM)}getMaxZoom(){return this.get(n.MAX_ZOOM)}getOpacity(){return this.get(n.OPACITY)}getSourceState(){return d()}getVisible(){return this.get(n.VISIBLE)}getZIndex(){return this.get(n.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(n.EXTENT,e)}setMaxResolution(e){this.set(n.MAX_RESOLUTION,e)}setMinResolution(e){this.set(n.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(n.MAX_ZOOM,e)}setMinZoom(e){this.set(n.MIN_ZOOM,e)}setOpacity(e){m(typeof e=="number","Layer opacity must be a number"),this.set(n.OPACITY,e)}setVisible(e){this.set(n.VISIBLE,e)}setZIndex(e){this.set(n.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const u={ADD:"add",REMOVE:"remove"},f={LENGTH:"length"};class y extends O{constructor(e,t,s){super(e),this.element=t,this.index=s}}class p extends I{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let s=0,i=this.array_.length;s<i;++s)this.assertUnique_(this.array_[s],s);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,s=e.length;t<s;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let s=0,i=t.length;s<i;++s)e(t[s],s,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(f.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new y(u.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let s=0,i=t.length;s<i;++s)if(t[s]===e)return this.removeAt(s)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new y(u.REMOVE,t,e)),t}setAt(e,t){const s=this.getLength();if(e>=s){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new y(u.REMOVE,i,e)),this.dispatchEvent(new y(u.ADD,t,e))}updateLength_(){this.set(f.LENGTH,this.array_.length)}assertUnique_(e,t){for(let s=0,i=this.array_.length;s<i;++s)if(this.array_[s]===e&&s!==t)throw new Error("Duplicate item added to a unique collection")}}class o extends O{constructor(e,t){super(e),this.layer=t}}const _={LAYERS:"layers"};class L extends N{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let s=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(_.LAYERS,this.handleLayersChanged_),s?Array.isArray(s)?s=new p(s.slice(),{unique:!0}):m(typeof s.getArray=="function","Expected `layers` to be an array or a `Collection`"):s=new p(void 0,{unique:!0}),this.setLayers(s)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(g),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(h(e,u.ADD,this.handleLayersAdd_,this),h(e,u.REMOVE,this.handleLayersRemove_,this));for(const s in this.listenerKeys_)this.listenerKeys_[s].forEach(g);R(this.listenerKeys_);const t=e.getArray();for(let s=0,i=t.length;s<i;s++){const a=t[s];this.registerLayerListeners_(a),this.dispatchEvent(new o("addlayer",a))}this.changed()}registerLayerListeners_(e){const t=[h(e,x.PROPERTYCHANGE,this.handleLayerChange_,this),h(e,v.CHANGE,this.handleLayerChange_,this)];e instanceof L&&t.push(h(e,"addlayer",this.handleLayerGroupAdd_,this),h(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[E(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new o("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new o("removelayer",e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new o("addlayer",t)),this.changed()}handleLayersRemove_(e){const t=e.element,s=E(t);this.listenerKeys_[s].forEach(g),delete this.listenerKeys_[s],this.dispatchEvent(new o("removelayer",t)),this.changed()}getLayers(){return this.get(_.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const s=t.getArray();for(let i=0,a=s.length;i<a;++i)this.dispatchEvent(new o("removelayer",s[i]))}this.set(_.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],s=t.length;this.getLayers().forEach(function(l){l.getLayerStatesArray(t)});const i=this.getLayerState();let a=i.zIndex;!e&&i.zIndex===void 0&&(a=0);for(let l=s,A=t.length;l<A;l++){const r=t[l];r.opacity*=i.opacity,r.visible=r.visible&&i.visible,r.maxResolution=Math.min(r.maxResolution,i.maxResolution),r.minResolution=Math.max(r.minResolution,i.minResolution),r.minZoom=Math.max(r.minZoom,i.minZoom),r.maxZoom=Math.min(r.maxZoom,i.maxZoom),i.extent!==void 0&&(r.extent!==void 0?r.extent=Z(r.extent,i.extent):r.extent=i.extent),r.zIndex===void 0&&(r.zIndex=a)}return t}getSourceState(){return"ready"}}const S=L;export{N as B,p as C,o as G,S as L,n as a,u as b};
